<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>linux第一个应用及makefile文件 | estrella</title>
  <meta name="author" content="estrella">
  
  <meta name="description" content="从一个简单的应用程序入手，介绍了开发一个Linux应用程序的流程。通过实例分析了编译和连接的原理，并且剖析了程序执行的过程。最后讲述了Makefile管理工程文件如何管理软件代码。请读者多实践，只有不断的实践才能对这部分的知识深入理解。
Linux develop创建一个应用编辑gedit main">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="linux第一个应用及makefile文件"/>
  <meta property="og:site_name" content="estrella"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-70812759-1', 'auto');
  ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?cb5448498d7169c668b07c2b255d62c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">estrella</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> linux第一个应用及makefile文件</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>从一个简单的应用程序入手，介绍了开发一个Linux应用程序的流程。通过实例分析了编译和连接的原理，并且剖析了程序执行的过程。最后讲述了Makefile管理工程文件如何管理软件代码。请读者多实践，只有不断的实践才能对这部分的知识深入理解。</p>
<h2 id="Linux-develop"><a href="#Linux-develop" class="headerlink" title="Linux develop"></a>Linux develop</h2><h3 id="创建一个应用"><a href="#创建一个应用" class="headerlink" title="创建一个应用"></a>创建一个应用</h3><p>编辑gedit main.c还有另一种是vi，但首推gedit<br>编译gcc -o main.c main<br>运行main程序./main</p>
<h2 id="嵌入式软件开发模式"><a href="#嵌入式软件开发模式" class="headerlink" title="嵌入式软件开发模式"></a>嵌入式软件开发模式</h2><p>嵌入式系统资源受限，直接在嵌入式系统硬件平台上编写软件较为困难。<br>解决方法<br>首先在通用计算机上编写软件<br>然后通过本地编译或者交叉编译生成目标平台上可以运行的二进制代码格式<br>最后再下载到目标平台上运行<br>（51单片机下载进去需要hex文件与bin文件区别在有地址，esp8266的ide开发用eclipse生成的bin文件下载进去，需要写地址）</p>
<h3 id="交叉编译的概念"><a href="#交叉编译的概念" class="headerlink" title="交叉编译的概念"></a>交叉编译的概念</h3><p>在一种平台上编译出能在另一种平台（体系结构不同）上运行的程序；<br>在PC平台(X86)上编译出能运行在ARM平台上的程序，即编译得到的程序在X86平台上不能运行，必须放到ARM平台上才能运行；<br>用来编译这种程序的编译器就叫交叉编译器；<br>为了不与本地编译器混淆，交叉编译器的名字一般都有前缀，例如：arm-linux-gcc</p>
<h3 id="交叉编译的原因"><a href="#交叉编译的原因" class="headerlink" title="交叉编译的原因"></a>交叉编译的原因</h3><p>1.目标平台所需要的Boot Loader以及OS核心还没有建立时，需要做交叉编译<br>2.目标机设备不具备一定的处理能力和存储空间</p>
<h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><h3 id="What-is-Makefile"><a href="#What-is-Makefile" class="headerlink" title="What is Makefile?"></a>What is Makefile?</h3><p>我们要做的是make，makefile是make的基础<br>Makefile是一个文本文件，是GNU make程序在执行的时候默认读取的配置文件。Makefile有强大的功能，它记录了文件之间的依赖关系，通过比对目标文件和依赖文件的时间戳，决定是否需要执行相应的命令；同时，Makefile还可以定义变量，接收用户传递的参数变量，通过这些元素的相互配合，省去了繁杂的编译命令，不仅节省时间，也减小了出错的概率。</p>
<h3 id="Brief-Introduction-of-Makefile"><a href="#Brief-Introduction-of-Makefile" class="headerlink" title="Brief Introduction of Makefile"></a>Brief Introduction of Makefile</h3><p>make 命令对于构建具有多个源文件的程序有很大的帮助<br>只有 make 命令还是不够的，还必须用 makefile 告诉它要做什么以及怎么做<br>make 命令和 Makefile 配合使用，能给项目管理带来极大便利。</p>
<h3 id="Composition-of-Makefile"><a href="#Composition-of-Makefile" class="headerlink" title="Composition of Makefile"></a>Composition of Makefile</h3><p>一个 makefile 由依赖关系和规则两部分内容组成: 1.规则用来说明怎样使用所依赖的文件来建立目标文件。2.依赖关系由一个目标和一组该目标所依赖的源文件组成。<br><img src="http://a1.qpic.cn/psb?/V11V3soz2JNi4c/fReSmwGoLbWCg*kR3GeHG1**vLZLnTjo18aIs2pw*j8!/c/dLgAAAAAAAAA&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=3AEQAQAAAAADF*4!&amp;tl=1&amp;vuin=3033668267&amp;tm=1554987600&amp;sce=60-2-2&amp;rf=0-0" alt=""><br>依赖关系如图示</p>
<h3 id="Rules-of-Makefile"><a href="#Rules-of-Makefile" class="headerlink" title="Rules of Makefile"></a>Rules of Makefile</h3><pre><code>目标：[依赖模块] 
    命令 
    命令
</code></pre><p><em>命令前必须是tab键</em></p>
<h3 id="make"><a href="#make" class="headerlink" title="make"></a>make</h3><p>Make的工作过程类似一次深度优先遍历过程</p>
<h3 id="the-Variables-of-Makefile"><a href="#the-Variables-of-Makefile" class="headerlink" title="the  Variables of Makefile"></a>the  Variables of Makefile</h3><p>1.objects变量（$(objects)）<br>objects = main.o kbd.o command.o \<br>        display.o insert.o search.o files.o utils.o<br>edit : $(objects)<br>        cc -o edit $(objects)<br>2.预定义变量<br>无视无视<br>3.内部变量<br>$@扩展成当前规则的目的文件名<br>$&lt;扩展成依靠列表中的第一个依靠文件<br>$^扩展成整个依靠的列表（除掉了里面所有重复的文件名） </p>
<h3 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h3><p>I just find it complicated to understand my makefile on the embeded system class, cause it was written from models given by Mrs Sun. Studying in B site is not realistic, while under a course vedio is a useful comment saying it is helpful to read the CN edition of GUN makefile mannul. I’ll try.</p>
<h2 id="应用举例"><a href="#应用举例" class="headerlink" title="应用举例"></a>应用举例</h2><p>编写加、减、乘、除功能的多文件程序，使用make工具，要求在makefile文件中使用内部变量。参考pdf文档。</p>
<pre><code>OBJS=main.o test.o test1.o test2.o test3.o
CC=gcc
CFLAGS = -c

test :$(OBJS)
    @$(CC) -o $@ $^

main.o : main.c test.h
    @$(CC) $(CFLAGS) $^

test.o : test.c test.h
    @$(CC) $(CFLAGS) $^

test1.o : test1.c test.h
    @$(CC) $(CFLAGS) $^

test2.o : test2.c test.h
    @$(CC) $(CFLAGS) $^

test3.o : test3.c test.h
    @$(CC) $(CFLAGS) $^

.PHONY clean:
    @rm -f  *.o  test
</code></pre><p><img src="http://a3.qpic.cn/psb?/V11V3soz2JNi4c/1lFAOBTjWzdesET3zXnbKvJbgS1BC8ouM2Y3HeXHyUE!/c/dL4AAAAAAAAA&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=0ALAAwAAAAARFzE!&amp;tl=1&amp;vuin=3033668267&amp;tm=1554998400&amp;sce=60-2-2&amp;rf=0-0" alt=""><br><img src="http://a4.qpic.cn/psb?/V11V3soz2JNi4c/oKeo7tXdh9GHL4sfbBMteVkJx8KlwIMOQHmusGqYWvk!/c/dL8AAAAAAAAA&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=wAPQAgAAAAARFzE!&amp;tl=1&amp;vuin=3033668267&amp;tm=1554998400&amp;sce=60-2-2&amp;rf=0-0" alt=""></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2019/04/12/linux建立静态库和动态库/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2019/03/27/linux开发：文件的编译流程/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2019-04-04 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/嵌入式/">嵌入式<span>4</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/嵌入式/">嵌入式<span>4</span></a></li> <li><a href="/tags/linux/">linux<span>4</span></a></li> <li><a href="/tags/makefile/">makefile<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2021 estrella
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
